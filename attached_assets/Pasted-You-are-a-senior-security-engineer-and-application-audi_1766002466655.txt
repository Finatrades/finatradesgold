You are a senior security engineer and application auditor.

TASK
Audit this entire Replit codebase for hacking, security vulnerabilities, and bad practices.
Assume the app is a financial platform (Finatrades-style) handling users, balances, transactions, and certificates.

OBJECTIVE
- Identify ALL security risks
- Explain WHY each issue is dangerous
- Show HOW an attacker could exploit it (brief)
- Provide SAFE, correct fixes with code examples

CHECK THESE AREAS (MANDATORY)

1Ô∏è‚É£ AUTHENTICATION & SESSIONS
- Check if passwords are:
  - hashed properly (bcrypt/argon2)
  - never stored or logged in plain text
- Check JWT/session handling:
  - access tokens expiration
  - refresh token security
  - httpOnly + secure cookies
- Check sign-in / sign-out logic:
  - session invalidation on logout
  - token reuse issues
- Look for:
  ‚ùå tokens in localStorage
  ‚ùå missing auth middleware
  ‚ùå routes accessible without login

2Ô∏è‚É£ API SECURITY
- Review all /api/* routes
- Verify:
  - auth validation exists on every sensitive endpoint
  - role checks for admin routes
- Check for:
  ‚ùå trusting client input
  ‚ùå missing userId validation
  ‚ùå ability to modify another user‚Äôs data
- Test:
  - Can user A fetch user B‚Äôs balances?
  - Can transactions be forged?

3Ô∏è‚É£ INPUT VALIDATION & INJECTION
- Scan for:
  ‚ùå SQL injection risks
  ‚ùå raw queries without parameters
  ‚ùå unsafe JSON parsing
- Validate:
  - amounts (USD, grams)
  - IDs
  - email inputs
- Check for XSS:
  ‚ùå dangerouslySetInnerHTML
  ‚ùå rendering raw user input in UI

4Ô∏è‚É£ BUSINESS LOGIC ATTACKS (VERY IMPORTANT)
- Check if attacker can:
  - add funds without payment
  - send negative amounts
  - unlock BNSL without lock
  - release FinaBridge settlement without approval
- Ensure:
  - balances never go negative
  - all state transitions are validated server-side
  - price snapshot cannot be manipulated by client

5Ô∏è‚É£ TRANSACTIONS & LEDGER SAFETY
- Verify transactions are:
  - append-only
  - never editable or deletable
- Check race conditions:
  - double spend
  - parallel requests
- Ensure DB operations are atomic (transactions)

6Ô∏è‚É£ CERTIFICATE SECURITY
- Check certificate generation:
  - cannot be forged via API
  - tied to transaction/ledger ID
- Ensure users cannot:
  - view others‚Äô certificates
  - download fake certificates

7Ô∏è‚É£ ENVIRONMENT & SECRETS
- Check for:
  ‚ùå secrets hardcoded in repo
  ‚ùå exposed API keys
- Verify:
  - .env is used correctly
  - secrets never sent to frontend
- Check Replit exposure risks

8Ô∏è‚É£ RATE LIMITING & DOS
- Identify missing protections:
  - login brute-force
  - transaction spam
- Recommend:
  - rate limits
  - request throttling

OUTPUT FORMAT (IMPORTANT)
For EACH issue:
- üî¥ Severity: Critical / High / Medium / Low
- üìç Location: file + function
- üí• Risk: what can go wrong
- üß† Exploit example (short)
- ‚úÖ Fix: exact code or config change

FINAL DELIVERABLE
- A clear SECURITY REPORT
- A ‚ÄúTop 10 Critical Fixes‚Äù summary
- A checklist to make the app production-ready